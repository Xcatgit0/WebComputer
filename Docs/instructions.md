# WebComputer Instruction Set

เอกสารนี้อธิบายคำสั่งทั้งหมดที่ใช้ในระบบคอมพิวเตอร์จำลองของคุณ (ยกเว้นคำสั่งที่เกี่ยวกับอุปกรณ์)

---

## 📌 โครงสร้างคำสั่งทั่วไป
opcode src1 src2
- `src1`, `src2`: เป็นเรจิสเตอร์ (เช่น `r1`) หรือตัวเลขทันที (immediate value)
- `label:` ใช้สำหรับสร้างจุดอ้างอิงเพื่อการ `jmp`, `call`, ฯลฯ

---

## 🧮 คำสั่งเลขคณิต

| คำสั่ง   | ความหมาย                  | ตัวอย่าง             |
|----------|----------------------------|----------------------|
| `add`    | บวก reg1 += reg2          | `add r1, r2`         |
| `sub`    | ลบ reg1 -= reg2           | `sub r1, r2`         |
| `mul`    | คูณ reg1 *= reg2          | `mul r1, r2`         |
| `div`    | หาร reg1 /= reg2 (floor)  | `div r1, r2`         |
| `adi`    | เพิ่มค่าทันที             | `adi r1, 5`          |
| `sdi`    | ลดค่าทันที                | `sdi r1, 10`         |

---

## 🧠 คำสั่งตรรกะและเปรียบเทียบ

| คำสั่ง   | ความหมาย                                   | ตัวอย่าง             |
|----------|---------------------------------------------|----------------------|
| `not`    | NOT reg1 → reg2 (ถ้า reg1 > 0 → 0, else 1) | `not r1, r2`         |
| `wise`   | NOT → reg1 = (reg1 > 0 ? 0 : 1)             | `wise r1`            |
| `cmp`    | เปรียบเทียบ reg1 - reg2 → ตั้งค่า flag    | `cmp r1, r2`         |

---

## 🗃️ คำสั่งข้อมูล

| คำสั่ง   | ความหมาย                          | ตัวอย่าง             |
|----------|------------------------------------|----------------------|
| `ldi`    | โหลดค่าทันทีใส่เรจิสเตอร์         | `ldi r1, 123`        |
| `mov`    | ย้ายค่าจาก reg1 → reg2            | `mov r1, r2`         |

---

## 🔁 การควบคุมการไหล (Jump & Call)

| คำสั่ง   | ความหมาย                                  | ตัวอย่าง           |
|----------|--------------------------------------------|--------------------|
| `jmp`    | กระโดดไปยัง label                          | `jmp loop`         |
| `call`   | เรียกฟังก์ชัน พร้อมบันทึกตำแหน่งปัจจุบัน | `call drawUI`      |
| `end`    | จบการทำงานของ `call` และ return กลับ      | `end`              |
| `goto`   | กระโดดแบบระบุตำแหน่ง (pc index)          | `goto 45`          |

---

## 📐 เงื่อนไขกระโดด

| คำสั่ง   | ความหมาย                                    | ตัวอย่าง         |
|----------|----------------------------------------------|------------------|
| `je`     | ถ้า zf == 1 ให้กระโดด                       | `je endloop`     |
| `jnz`    | ถ้า reg2 != 0 ให้กระโดด                     | `jnz loop`       |
| `jez`    | ถ้า reg2 == 0 ให้กระโดด                     | `jez exit`       |
| `jgz`    | ถ้า reg2 > 0 ให้กระโดด                      | `jgz skip`       |

---

## 📤/📥 I/O

| คำสั่ง   | ความหมาย                     | ตัวอย่าง             |
|----------|-------------------------------|----------------------|
| `in`     | อ่านค่าจาก address → reg2     | `in r1, r2`          |
| `out`    | เขียนค่าจาก reg2 → address   | `out r1, r2`         |

---

## 🖥️ Terminal (TTY)

| คำสั่ง   | ความหมาย                                      | ตัวอย่าง                |
|----------|------------------------------------------------|-------------------------|
| `tty`    | คำสั่งเกี่ยวกับเทอร์มินัล                    | `tty 1, "Hello"`        |

| mode | ความหมาย                        |
|------|---------------------------------|
| `0`  | แสดง ASCII character จากค่าตัวเลข |
| `1`  | แสดงข้อความ                      |
| `2`  | ล้างหน้าจอ                       |
| `3`  | แสดง string จาก char codes      |

---

## 🏷️ Preprocessor

| คำสั่ง     | ความหมาย                                       | ตัวอย่าง            |
|------------|--------------------------------------------------|---------------------|
| `define`   | นิยามค่าคงที่                                   | `define size, 128`  |
| `Rdefine`  | โหลด define ใหม่เข้าโปรแกรม (reprocess code)   | `Rdefine`           |

---

## ⛔ คำสั่งหยุด

| คำสั่ง   | ความหมาย                     | ตัวอย่าง     |
|----------|-------------------------------|--------------|
| `hlt`    | หยุดเครื่องและเซฟ disk       | `hlt`        |

---

## ❓ คำสั่งอื่น

ยังไม่มี

---

## 🧾 หมายเหตุ

- ตัวแปร เช่น `r0`, `r1`, ... `r63` คือเรจิสเตอร์ 64 ตัว
- คำสั่งรับค่าผ่าน define ได้ เช่น `define max, 100` แล้วใช้ `ldi r1, max`
- `;` ใช้สำหรับ comment

---

> © Document generated for internal use by the WebComputer system.
